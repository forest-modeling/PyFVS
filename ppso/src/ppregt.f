      SUBROUTINE PPREGT (XPPMLT,BX,BAB,CCFO)
      IMPLICIT NONE
C----------
C  **PPREGT--SO DATE OF LAST REVISION:  09/18/08
C----------
C
C     IF ARGUMENT LIST CHANGES, ALSO CHANGE EXPPNB ROUTINE
C
C     COMPUTE THE REGENT MULTIPLIER THAT ACCOUNTS FOR THE DENSITY
C     OF NEIGHBORING STANDS.
C
C     PART OF THE PARALLEL PROCESSING EXTENSION OF PROGNOSIS SYSTEM.
C     N.L. CROOKSTON--FORESTRY SCIENCES LAB, MOSCOW, ID--NOV 1992
C
C     MODIFIED FOR SORNEC        BY   GARY DIXON -- FT COLLINS, CO
C                                     FOREST MANAGEMENT SERVICE CENTER
C     CALLED FROM: GRADD.
C
COMMONS
C
C
      INCLUDE 'PPDNCM.F77'
C
C
COMMON
C
      REAL BAB(9),CCFO,BX,XPPMLT,X,PCTRED
C
C----------
C     IF THE NEIGHBOR DENSITY EFFECTS ARE BEING INCLUDED, THEN
C     CALCULATE THEM, OTHERWISE, RETURN.
C
C     NOTE: THIS COMPUTES A PERCENTAGE REDUCTION FACTOR WHICH
C     APPLIED VIA THE POTENTIAL-MODIFIER LOGIC
C----------
      IF (LNEDNS) THEN
         X=BX*AMAX1(0.0,PDCCFN-CCFO)
         IF(X.GT. 300.)X=300.
         XPPMLT=BAB(1) +
     &      X*(BAB(2) + X*(BAB(3) + X*(BAB(4) + X*(BAB(5)+ X*BAB(6)))))
         IF(XPPMLT .GT. 1.0) PCTRED = 1.0
         IF(XPPMLT .LT. 0.01) PCTRED = 0.01
      ENDIF
      RETURN
      END
