      SUBROUTINE PPREGT (XPPMLT,CCFO,BALO,ALBAO,BCCF,BBAL,BLBA,JSPC)
      IMPLICIT NONE
C----------
C  **PPREGT--KT DATE OF LAST REVISION:  09/18/08
C----------
C
C     IF ARGUMENT LIST CHANGES, ALSO CHANGE EXPPNB ROUTINE
C
C     COMPUTE THE REGENT MULTIPLIER THAT ACCOUNTS FOR THE DENSITY
C     OF NEIGHBORING STANDS.
C
C     PART OF THE PARALLEL PROCESSING EXTENSION OF PROGNOSIS SYSTEM.
C     N.L. CROOKSTON--FORESTRY SCIENCES LAB, MOSCOW, ID--NOV 1992
C
C     MODIFIED FOR KOOKANTL VARIANT BY GARY DIXON -- FT COLLINS, CO
C                                      FOREST MANAGEMENT SERVICE CENTER
C     CALLED FROM: GRADD.
C
COMMONS
C
C
      INCLUDE 'PPDNCM.F77'
C
C
COMMON
C----------
C
C
      INTEGER JSPC
      REAL XPPMLT,CCFO,BALO,ALBAO,BCCF,BBAL,BLBA,ALPDB
C
C
C     IF THE NEIGHBOR DENSITY EFFECTS ARE BEING INCLUDED, THEN
C     CALCULATE THEM, OTHERWISE, RETURN.
C
C     FIRST TERM IS ALOG  STAND BA
C     SECOND TERM IS BAL
C       NOTE: ASSUME ADDITIONAL STAND BA WILL BE IN BIGGER TREES
C     THIRD TERM IS CCF
C----------
      IF (LNEDNS) THEN
         ALPDB=0.0
         IF(PDBAN.GT.0.)ALPDB=ALOG(PDBAN)
         XPPMLT=     BLBA*(AMAX1(0.0,ALPDB-ALBAO)) +
     >               BBAL*(AMAX1(0.0,PDBAN-BALO))  +
     >               BCCF*(AMAX1(0.0,PDCCFN-CCFO))
         IF(JSPC.EQ.11)XPPMLT=EXP(XPPMLT)
      ENDIF
      RETURN
      END
