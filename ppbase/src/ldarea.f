      SUBROUTINE LDAREA
      IMPLICIT NONE
C----------
C  **LDAREA--PPBASE  DATE OF LAST REVISION:  07/31/08
C----------
C
C     MAKES SURE THAT THE ARRAY 'AREAS' IS LOADED FROM THE DATA
C     IN THE AREALOCS FILE.
C
C     PART OF THE PARALLEL PROCESSING EXTENSION OF PROGNOSIS SYSTEM.
C     N.L. CROOKSTON--FORESTRY SCIENCES LAB, MOSCOW, ID--JUN 1988.
C
COMMONS
C
C
      INCLUDE 'PRGPRM.F77'
C
C
      INCLUDE 'PPEPRM.F77'
C
C
      INCLUDE 'PPCNTL.F77'
C
C
COMMONS
C
C
C
      INTEGER IRC,INOT,I
      REAL ACTARA
C
C
C     IF THE AREA DATA HAS BEEN LOADED, THEN EXIT
C
      IF (PDEBUG) WRITE (JOPPRT,'(/'' IN LDAREA, LAREAS='',L2)') LAREAS
C
      IF (LAREAS) RETURN
C
C     SET UP THE STAND ID SORT.
C
      CALL C26SRT (NOSTND,STDIDS,ISNSRT,.TRUE.)
      CALL SPLAEX (STDIDS,NOSTND,ISNSRT,IRC)
      IF (PDEBUG) WRITE (JOPPRT,'(/'' IN LDAREA, IRC FROM SPLAEX='',
     >    I2,'' NOSTND='',I5)') IRC,NOSTND
C
C     IF THERE ARE NOT LOCATION DATA, LIVE LAREAS FALSE AND RETURN.
C
      IF (IRC.EQ.2) RETURN
C
      INOT=0
      DO 100 I=1,NOSTND
C
C     GET THE STAND AREA (ACTUAL AREA=ACTARA) AND MULTIPLY IT
C     TIMES THE BRANCH WEIGHT...USE THE PRODUCT AS THE WEIGHT.
C
      CALL SPLAAR (I,ACTARA,IRC)
      IF (IRC.NE.0) THEN
         INOT=INOT+1
         ACTARA=1.0
      ENDIF
      AREAS(I)=ACTARA
C
  100 CONTINUE
      IF (INOT.GT.0) WRITE (JOPPRT,'(/'' ********   WARNING:  '',
     >   ''AREAS FOR '',I5,'' STANDS HAVE BEEN DEFAULTED TO 1.0'')')
     >   INOT
      LAREAS=.TRUE.
      RETURN
      END
