      SUBROUTINE PPKEY (CTOK,NUM,IRC)
      IMPLICIT NONE
C----------
C  **PPKEY  DATE OF LAST REVISION:  07/31/08
C----------
C
C     CALLED FROM ALGCMP
C
C     FINDS CTOK IN THE ARRAY OF PPE-LEVEL USER-DEFINED VARIABLES.
C
C     N.L.CROOKSTON - JULY 87 - FORESTRY SCIENCES LAB - MOSCOW, ID
C
C     CTOK  = C*8 TOKEN FOUND IN AN EXPRESSION.
C     NUM   = THE LOAD OP-CODE FOR THE TOKEN, IF IT IS DEFINED.
C     IRC   = RETURN CODE, 0=CTOK WAS FOUND, NUM IS DEFINED.
C             1=CTOK WAS NOT FOUND, NUM IS UNDEFINED.
C
COMMONS
C
C
      INCLUDE 'PPEXCM.F77'
C
C
COMMONS
C
      INTEGER IRC,NUM,I
      CHARACTER*8 CTOK
C
C     IF THERE ARE NO USER DEFINED VARIABLES, THEN BRANCH TO EXIT
C
      IF (NPTST2.LE.0) GOTO 110
C
C     SEARCH THROUGH LIST OF USER DEFINED VARILABLES.
C
      DO 10 I=1,NPTST2
      NUM=I
      IF (CTOK.EQ.CPTST2(I)) GOTO 20
   10 CONTINUE
      NUM=0
      GOTO 110
   20 CONTINUE
      NUM=2200+NUM
      IRC=0
      RETURN
  110 CONTINUE
      IRC=1
      RETURN
      END
