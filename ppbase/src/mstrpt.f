      SUBROUTINE MSTRPT
      IMPLICIT NONE
C----------
C  **MSTRPT  DATE OF LAST REVISION:  07/31/08
C----------
C
C     STORE THE MASTER OPTION LIST IN TEMPORARY SPACE.
C
C     PART OF THE PARALLEL PROCESSING EXTENSION OF PROGNOSIS SYSTEM.
C
C     CALLED FROM INSTND
C
COMMONS
C
C
      INCLUDE 'PRGPRM.F77'
C
C
      INCLUDE 'PPEPRM.F77'
C
C
      INCLUDE 'ARRAYS.F77'
C
C
      INCLUDE 'CONTRL.F77'
C
C
      INCLUDE 'OPCOM.F77'
C
C
      INCLUDE 'PPCNTL.F77'
C
C
COMMONS
C
C
      INTEGER MXINTS,MXLOGS,LNCBUF,ILIMIT,IPNT,K,I,J
      LOGICAL LOGICS(MXLOGS)
      PARAMETER (MXINTS=12,MXLOGS=3)
      INTEGER INTS(MXINTS)
      CHARACTER CBUFF(4096),CHRONE
C
C     *$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$
C     THE FOLLOWING CODE MAY BE MACHINE DEPENDENT.  IT MAY BE REMOVED
C     WITH AN INCREASE IN MEMORY REQUIREMENTS BUT NO LOSS IN FUNCTION.
C
      EQUIVALENCE (CBUFF,WK6)
C     *$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$
C
      DATA LNCBUF/4096/,CHRONE/'A'/
C
      ILIMIT=IRECLN
      IF (ILIMIT.GT.MAXBUF) ILIMIT=MAXBUF
      IF (PDEBUG) WRITE (JOPPRT,'('' IN MSTRPT: IMSREC,IMSEND='',
     >            2I5)') IMSREC,IMSEND
C
C     RELEASE ANY PREVIOUS PATTERNS ON THE DISK.
C
      IF (IMSREC.GT.0) CALL SPARLS(IMSREC,IMSEND)
C
C     IWTREC IS FIRST SET IN SPAMGM, LATER IN STASH AND CHSTSH.
C
      IMSREC=IWTREC
C
      INTS ( 1) = IMG1
      INTS ( 2) = IMG2
      INTS ( 3) = IMGL
      INTS ( 4) = IEPT
      INTS ( 5) = IMPL
      INTS ( 6) = ICOD
      INTS ( 7) = IEVT
      INTS ( 8) = IEVA
      INTS ( 9) = ILGNUM
      INTS (10) = LENSLS
      INTS (11) = ITST5
      INTS (12) = ITOPRM
      CALL IFWRIT (WK3,IPNT,ILIMIT,INTS,   MXINTS,    1)
C
      K=IMGL-1
      DO 1 I=1,4
      CALL IFWRIT (WK3,IPNT,ILIMIT,IACT(1,I),K,    2)
    1 CONTINUE
      CALL IFWRIT (WK3,IPNT,ILIMIT,IDATE, K,       2)
      CALL IFWRIT (WK3,IPNT,ILIMIT,IOPCYC,K,       2)
      CALL IFWRIT (WK3,IPNT,ILIMIT,IOPSRT,K,       2)
      CALL IFWRIT (WK3,IPNT,ILIMIT,ISEQ,  K,       2)
      K=MAXACT-IEPT+1
      DO 2 I=1,4
      CALL IFWRIT (WK3,IPNT,ILIMIT,IACT(IEPT,I),K, 2)
    2 CONTINUE
      CALL IFWRIT (WK3,IPNT,ILIMIT,IDATE(IEPT), K, 2)
      CALL IFWRIT (WK3,IPNT,ILIMIT,ISEQ(IEPT),  K, 2)
      K=IEVA-1
      IF (K.GT.0) THEN
         DO 10 I=1,6
         CALL IFWRIT (WK3,IPNT,ILIMIT,IEVACT(1,I),K,  2)
   10    CONTINUE
         CALL IFWRIT (WK3,IPNT,ILIMIT,LENAGL,K,       2)
      ENDIF
      CALL IFWRIT (WK3,IPNT,ILIMIT,IEVCOD,ICOD-1,  2)
      CALL IFWRIT (WK3,IPNT,ILIMIT,IEVNTS(1,1),IEVT-1,2)
      CALL IFWRIT (WK3,IPNT,ILIMIT,IEVNTS(1,2),IEVT-1,2)
      CALL IFWRIT (WK3,IPNT,ILIMIT,IEVNTS(1,3),IEVT-1,2)
C
C     WRITE THE LOGICAL VARIABLES.
C
      LOGICS(1)=LOPEVN
      LOGICS(2)=LBSETS
      LOGICS(3)=LEVUSE
      CALL LFWRIT (WK3,IPNT,ILIMIT,LOGICS,   MXLOGS,  2)
C
C     WRITE THE REAL VARIABLES.
C
      CALL BFWRIT (WK3,IPNT,ILIMIT,PARMS,IMPL-1  ,2)
      CALL BFWRIT (WK3,IPNT,ILIMIT,PARMS(ITOPRM),  MAXPRM-ITOPRM+1, 3)
C
      IF (LBSETS .OR. ITST5.GT.0) THEN
         CALL CHWRIT (CBUFF,IPNT,LNCBUF,CHRONE(1:1),1)
         IF (ITST5.GT.0) THEN
            DO 95 J=1,ITST5
            DO 95 I=1,8
            CALL CHWRIT (CBUFF,IPNT,LNCBUF,CTSTV5(J)(I:I),2)
   95       CONTINUE
         ENDIF
         IF (LENSLS.GT.0) THEN
            DO 510 K=1,LENSLS
            CALL CHWRIT (CBUFF,IPNT,LNCBUF,SLSET(K:K),2)
  510       CONTINUE
         ENDIF
         IF (IEVA-1.GT.0) THEN
            DO 550 I=1,(IEVA-1)
            J=LENAGL(I)
            IF (J.GE.1) THEN
               DO 540 K=1,J
               CALL CHWRIT (CBUFF,IPNT,LNCBUF,AGLSET(I)(K:K),2)
  540          CONTINUE
            ENDIF
  550       CONTINUE
         ENDIF
         CALL CHWRIT (CBUFF,IPNT,LNCBUF,CHRONE(1:1),3)
      ENDIF
C
      IMSEND=IOSTRC
C
      IF (PDEBUG) WRITE (JOPPRT,'('' IN MSTRPT: IMSREC,IMSEND='',
     >            2I5)') IMSREC,IMSEND
      RETURN
      END
