      SUBROUTINE CHSTSH (CBUFF,LNCBUF)
      IMPLICIT NONE
C----------
C  **CHSTSH   DATE OF LAST REVISION:  07/31/08
C----------
C     WRITE A BUFFER (CBUFF) FULL OF CHAR DATA TO DA FILE IDAIO.
C
C     PART OF THE PARALLEL PROCESSING EXTENSION OF PROGNOSIS SYSTEM.
C     NL CROOKSTON--FORESTRY SCIENCES LAB, MOSCOW, ID--FEB 1987
C
C     CALLED FROM CHWRIT
C
C     CBUFF = CBUFF FULL OF DATA TO BE CHSTSHED IN DIRECT ACCESS FILE.
C     LNCBUF= LENGTH OF CBUFF.
C
COMMONS
C
C
      INCLUDE 'PRGPRM.F77'
C
C
      INCLUDE 'PPEPRM.F77'
C
C
      INCLUDE 'PPCNTL.F77'
C
C
COMMONS
C
C
      INTEGER LNCBUF,ISUB,I
      CHARACTER CBUFF(LNCBUF)
      IF (PDEBUG) WRITE (JOPPRT,20) IWTREC,INEXR(IOSTRC),LNCBUF
   20 FORMAT (' IN CHSTSH: IWTREC= ',I5,' INEXR(IOSTRC)= ',I5,
     >        ' LNCBUF= ',I6)
C
C     FIND OUT WHICH ACTUAL RECORD AND FILE WE ARE GOING TO USE.
C
      ISUB=0
      DO 10 I=1,NDAFL
      IF (IWTREC.LE.NDACUM(I)) THEN
         WRITE (IDAIO(I),REC=IWTREC-ISUB) CBUFF
         IOSTRC=IWTREC
         CALL SPASGN (IWTREC)
         INEXR(IOSTRC)=IWTREC
         RETURN
      ELSE
         ISUB=NDACUM(I)
      ENDIF
   10 CONTINUE
C
C     IF THE LOOP EXITS, THEN FILE SPACE DOES NOT EXIST.
C
      CALL PPERRP (.FALSE.,1)
      RETURN
      END
