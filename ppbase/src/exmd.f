      SUBROUTINE EXMD
      IMPLICIT NONE
C----------
C  **EXMD--PPBASE   DATE OF LAST REVISION:  07/31/08
C----------
C
C     $*$*$*$   SPECIAL VERSION OF EXMPB TO BE USED WITH THE
C     $*$*$*$   MOUNTAIN PINE BEETLE DISPERSAL MODEL AS ATTACHED TO
C     $*$*$*$   THE PARALLEL PROCESSING EXTENSTION
C
C     EXTRA EXTERNAL REFERENCES FOR MPB CALLS
C
COMMONS
C
C
      INCLUDE 'PRGPRM.F77'
C
C
      INCLUDE 'PPEPRM.F77'
C
C
      INCLUDE 'ARRAYS.F77'
C
C
      INCLUDE 'CONTRL.F77'
C
C
      INCLUDE 'PPMDCM.F77'
C
C
      INCLUDE 'PPCNTL.F77'
C
C
COMMONS
C
      INTEGER MGMID,LDELTR,IISPI,IR,IITH,II,I,ICL,KEY
      LOGICAL L,LKECHO,LN(*)
      INTEGER*4 IDD
      INTEGER ICODES(6)
      CHARACTER*8 KEYWRD,NOMPB,CHDUM
      REAL ACHDUM(*)

      CHARACTER*26 NPLT
      DATA NOMPB/'*NO MPB'/
      ENTRY MPBINT
      RETURN
      ENTRY MPBHED (NPLT,MGMID)
      RETURN
      ENTRY MPBIN(CHDUM,ACHDUM,LN,LKECHO)
      CALL ERRGRO (.TRUE.,11)
      RETURN
      ENTRY MPBOPS
      RETURN
      ENTRY MPBCUP
      RETURN
      ENTRY MPBGO (L)
      L = .FALSE.
      RETURN
      ENTRY MPBDAM (II,IDD,ICODES,IITH,IR,IISPI,LDELTR)
      RETURN
      ENTRY MPBOUT
      RETURN
C
C
      ENTRY MPSDLP
C
C     INITIALIZE THE DEAD LPP
C
      DO 10 I=1,8
      VOLLP(ISTND,I)=0.0
   10 CONTINUE
C
C     IF THERE ARE DEAD TREES THEN: SET MDSDIX EQUAL TO THE INVENTORY
C     YEAR AND SUM UP THE VOLLP PER ACRE BY DBH CLASS.
C
      MDSDIX(ISTND)=IY(1)
      IF (IREC2.LT.MAXTP1) THEN
         DO 20 I=1,MAXTRE
         IF (ISP(I).EQ.7) THEN
C
C  COMMENT OUT THE FOLLOWING CALL TO MDDBHC UNTIL THE HISTORY
C  BEHIND IT IS DETERMINED
C
C            CALL MDDBHC (DBH(I),ICL)
C
C           ONLY COUNT THE 10 INCH AND LARGER TREES.
C
            IF (ICL.GE.3) VOLLP(ISTND,ICL)=VOLLP(ISTND,ICL)+PROB(I)
         ENDIF
   20    CONTINUE
      ENDIF
      IF (LMDDEB) WRITE (JOPPRT,'(/'' IN EXMD: ISTND,MDSDIX,VOLLP='',
     >   2I5,7F9.2)') ISTND,MDSDIX(ISTND),(VOLLP(ISTND,I),I=1,7)
      RETURN
C
C
      ENTRY MPKEY(KEY,KEYWRD)
      KEYWRD=NOMPB
      RETURN
      END
