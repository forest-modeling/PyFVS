      SUBROUTINE MSTRGT
      IMPLICIT NONE
C----------
C  **MSTRGT  DATE OF LAST REVISION:  07/31/08
C----------
C
C     GET MASTER OPTION LIST FROM TEMPORARY SPACE.
C
C     PART OF THE PARALLEL PROCESSING EXTENSION OF PROGNOSIS SYSTEM.
C
COMMONS
C
C
      INCLUDE 'PRGPRM.F77'
C
C
      INCLUDE 'PPEPRM.F77'
C
C
      INCLUDE 'ARRAYS.F77'
C
C
      INCLUDE 'CONTRL.F77'
C
C
      INCLUDE 'OPCOM.F77'
C
C
      INCLUDE 'PPCNTL.F77'
C
C
COMMONS
C
C
      INTEGER MXLOGS,MXINTS,LNCBUF,ILIMIT,IPNT,K,I,J
      LOGICAL LOGICS(MXLOGS)
      PARAMETER (MXINTS=12,MXLOGS=3)
      INTEGER INTS(MXINTS)
      EQUIVALENCE (WK6,LOGICS,INTS)
      CHARACTER CBUFF(4096),CHRONE
C
C     *$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$
C     THE FOLLOWING CODE MAY BE MACHINE DEPENDENT.  IT MAY BE REMOVED
C     WITH AN INCREASE IN MEMORY REQUIREMENTS BUT NO LOSS IN FUNCTION.
C
      EQUIVALENCE (CBUFF,WK6)
C     *$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$*$
C
      DATA LNCBUF/4096/,CHRONE/'A'/
C
      IF (PDEBUG) WRITE (JOPPRT,'('' IN MSTRGT: IMSREC,LTMPAC='',
     >            I5,1X,L1)') IMSREC,LTMPAC
C
C     IF THIS STAND IS NOT USING THE TEMPLATE, USE THE REGULAR
C     OPTION PROCESSOR INITIALIZATION.
C
      IF (.NOT. LTMPAC) THEN
         CALL OPINIT
         IRDREC=0
         GOTO 900
      ENDIF
      ILIMIT=IRECLN
      IF (ILIMIT.GT.MAXBUF) ILIMIT=MAXBUF
C
      IRDREC=IMSREC
C
      CALL IFREAD (WK3,IPNT,ILIMIT,INTS,   MXINTS,    1)
      IMG1   = INTS ( 1)
      IMG2   = INTS ( 2)
      IMGL   = INTS ( 3)
      IEPT   = INTS ( 4)
      IMPL   = INTS ( 5)
      ICOD   = INTS ( 6)
      IEVT   = INTS ( 7)
      IEVA   = INTS ( 8)
      ILGNUM = INTS ( 9)
      LENSLS = INTS (10)
      ITST5  = INTS (11)
      ITOPRM = INTS (12)
C
      K=IMGL-1
      DO 1 I=1,4
      CALL IFREAD (WK3,IPNT,ILIMIT,IACT(1,I),K,    2)
    1 CONTINUE
      CALL IFREAD (WK3,IPNT,ILIMIT,IDATE, K,       2)
      CALL IFREAD (WK3,IPNT,ILIMIT,IOPCYC,K,       2)
      CALL IFREAD (WK3,IPNT,ILIMIT,IOPSRT,K,       2)
      CALL IFREAD (WK3,IPNT,ILIMIT,ISEQ,  K,       2)
      K=MAXACT-IEPT+1
      DO 2 I=1,4
      CALL IFREAD (WK3,IPNT,ILIMIT,IACT(IEPT,I),K, 2)
    2 CONTINUE
      CALL IFREAD (WK3,IPNT,ILIMIT,IDATE(IEPT), K, 2)
      CALL IFREAD (WK3,IPNT,ILIMIT,ISEQ(IEPT),  K, 2)
      K=IEVA-1
      IF (K.GT.0) THEN
         DO 10 I=1,6
         CALL IFREAD (WK3,IPNT,ILIMIT,IEVACT(1,I),K,  2)
   10    CONTINUE
         CALL IFREAD (WK3,IPNT,ILIMIT,LENAGL,K,       2)
      ENDIF
      CALL IFREAD (WK3,IPNT,ILIMIT,IEVCOD,ICOD-1,  2)
      CALL IFREAD (WK3,IPNT,ILIMIT,IEVNTS(1,1),IEVT-1,2)
      CALL IFREAD (WK3,IPNT,ILIMIT,IEVNTS(1,2),IEVT-1,2)
      CALL IFREAD (WK3,IPNT,ILIMIT,IEVNTS(1,3),IEVT-1,2)
C
C     GET THE LOGICALS
C
      CALL LFREAD (WK3,IPNT,ILIMIT,LOGICS,   MXLOGS,  2)
      LOPEVN=LOGICS(1)
      LBSETS=LOGICS(2)
      LEVUSE=LOGICS(3)
C
C     GET THE REALS.
C
      CALL BFREAD (WK3,IPNT,ILIMIT,PARMS,IMPL-1  ,2)
      CALL BFREAD (WK3,IPNT,ILIMIT,PARMS(ITOPRM), MAXPRM-ITOPRM+1 ,3)
C
      IF (LBSETS .OR. ITST5.GT.0) THEN
         CALL CHREAD (CBUFF,IPNT,LNCBUF,CHRONE(1:1),1)
         IF (ITST5.GT.0) THEN
            DO 95 J=1,ITST5
            DO 95 I=1,8
            CALL CHREAD (CBUFF,IPNT,LNCBUF,CTSTV5(J)(I:I),2)
   95       CONTINUE
         ENDIF
         IF (LENSLS.GT.0) THEN
            DO 510 K=1,LENSLS
            CALL CHREAD (CBUFF,IPNT,LNCBUF,SLSET(K:K),2)
  510       CONTINUE
         ENDIF
         IF (IEVA-1.GT.0) THEN
            DO 550 I=1,(IEVA-1)
            J=LENAGL(I)
            IF (J.GE.1) THEN
               DO 540 K=1,J
               CALL CHREAD (CBUFF,IPNT,LNCBUF,AGLSET(I)(K:K),2)
  540          CONTINUE
            ENDIF
  550       CONTINUE
         ENDIF
         CALL CHREAD (CBUFF,IPNT,LNCBUF,CHRONE(1:1),3)
      ENDIF
C
  900 CONTINUE
      IF (PDEBUG) WRITE (JOPPRT,'('' IN MSTRGT: IMSREC,IRDREC='',
     >            2I5)') IMSREC,IRDREC
      RETURN
      END
